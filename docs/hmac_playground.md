### –ø—Ä–∏–º–µ—Ä –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –ø–æ–¥–ø–∏—Å–∏

–ú—ã –±–µ—Ä—ë–º —Ç–≤–æ–π **merchant id** –∏ **secret key**.
–ù–∞–ø—Ä–∏–º–µ—Ä:

```env
PAYTRAIL_MERCHANT_ID=375917
PAYTRAIL_SECRET_KEY=SAIPPUAKAUPPIAS
```

---

### 1. –ß—Ç–æ —Ç–∞–∫–æ–µ –ø–æ–¥–ø–∏—Å—å (signature)

–ü—Ä–µ–¥—Å—Ç–∞–≤—å:
–¢—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—à—å –∑–∞–∫–∞–∑ –≤ Paytrail ‚Üí `{–Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞, —Å—É–º–º–∞, –≤–∞–ª—é—Ç–∞}`.
–ß—Ç–æ–±—ã –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –Ω–µ –ø–æ–¥–º–µ–Ω–∏–ª –¥–∞–Ω–Ω—ã–µ –ø–æ –ø—É—Ç–∏, Paytrail –ø—Ä–æ—Å–∏—Ç:
üëâ ¬´–ø–æ—Å—Ç–∞–≤—å –ø–æ–¥–ø–∏—Å—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º —Å–µ–∫—Ä–µ—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π –∑–Ω–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç—ã –∏ Paytrail¬ª.

–≠—Ç–∞ –ø–æ–¥–ø–∏—Å—å = **—Ö—ç—à (HMAC-SHA256)**.

---

### 2. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏

–ë–µ—Ä—ë–º –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```php
$data = [
    'orderNumber' => '12345',
    'amount' => 1990,        // —Ü–µ–Ω–∞ –≤ —Ü–µ–Ω—Ç–∞—Ö (19.90 ‚Ç¨)
    'currency' => 'EUR',
    'merchantId' => 375917,
];
```

–ò–∑ –Ω–∏—Ö –¥–µ–ª–∞–µ–º —Å—Ç—Ä–æ–∫—É (Paytrail —Ç—Ä–µ–±—É–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø–æ–ª–µ–π, –Ω–æ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ —Å–¥–µ–ª–∞–µ–º —Ç–∞–∫):

```
12345|1990|EUR|375917
```

---

### 3. –î–µ–ª–∞–µ–º –ø–æ–¥–ø–∏—Å—å (PHP)

```php
<?php

$secret = "SAIPPUAKAUPPIAS"; // –∏–∑ .env

// –î–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞
$message = "12345|1990|EUR|375917";

// –î–µ–ª–∞–µ–º HMAC-SHA256
$signature = hash_hmac('sha256', $message, $secret);

// –í—ã–≤–æ–¥–∏–º
echo $signature;
```

–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (–±—É–¥–µ—Ç –¥–ª–∏–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ 64 —Å–∏–º–≤–æ–ª–∞, —Ç–∏–ø–∞):

```
6f8c33a8a41d7eeb7e1d44a2c9d3f5b019dbb8944c9a04d5c41ef6e4a9e1a2e7
```

---

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ Paytrail

* –¢—ã –æ—Ç–ø—Ä–∞–≤–∏–ª –¥–∞–Ω–Ω—ã–µ + —ç—Ç—É –ø–æ–¥–ø–∏—Å—å.
* Paytrail —É —Å–µ–±—è –±–µ—Ä—ë—Ç —Ç–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ, —Ç–æ–∂–µ –¥–µ–ª–∞–µ—Ç `hash_hmac('sha256', message, secret)` —Å–≤–æ–∏–º –∫–ª—é—á–æ–º
  (–£ Paytrail –≤ –∏—Ö —Å–∏—Å—Ç–µ–º–µ (–Ω–∞ –∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö) —Ç–æ–∂–µ –∑–∞–ø–∏—Å–∞–Ω —Ç–æ—á–Ω–æ —Ç–∞–∫–æ–π –∂–µ –∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —Ä–∞–∑–¥–µ–ª—è–µ—Ç–µ –≤–¥–≤–æ—ë–º (shared secret)
* –ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å–∏ —Å–æ–≤–ø–∞–ª–∏ ‚Üí –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–¥–¥–µ–ª–∞–Ω—ã.

---

üìå –ì–ª–∞–≤–Ω–æ–µ:

* `PAYTRAIL_SECRET_KEY` ‚Äî —ç—Ç–æ –Ω–µ ¬´–∫–ª—é—á –¥–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏¬ª, –∞ **–∫–ª—é—á –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ —Å–æ–æ–±—â–µ–Ω–∏–π**.
* –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É: *–µ—Å–ª–∏ –ø–æ–¥–ø–∏—Å—å —Å–æ–≤–ø–∞–ª–∞ ‚Üí –¥–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–º*.

---

